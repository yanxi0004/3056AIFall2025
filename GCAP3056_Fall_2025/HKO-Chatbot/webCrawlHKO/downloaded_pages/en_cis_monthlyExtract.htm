<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <title>Monthly Extract of Meteorological Observations｜Hong Kong Observatory(HKO)｜Climate Information Service</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="Monthly Extract of Meteorological Observations">
    <meta name="description" content="Monthly Extract of Meteorological Observations">
    <meta name="recordId" content="2018123100000006968">
    <meta name="lang" content="en">
	<meta property="fb:app_id" content="468280339992518" />
	<meta property="og:type" content="website" />
	<meta property="og:title" content="Monthly Extract of Meteorological Observations" />
	<meta property="og:description" content="&amp;nbsp; Back YearGo Trace means rainfall less than 0.05 mm ^ Information of wind direction and wind speed for Waglan Island are based on automatic weather station data since August" />
	<meta property="og:image" content="" />
	<meta property="og:url" content="https://www.hko.gov.hk/en/cis/monthlyExtract.htm" />
	<meta property="og:image:width" content="600" />
	<meta property="og:image:height" content="314" />
    <!-- Bootstrap -->
    <link id="styleSheet0" href="/css/bootstrap.css" rel="stylesheet" media="screen" type="text/css">
    <link id="styleSheet1" href="/css/bsplus.css" rel="stylesheet" media="all" type="text/css">
    <link id="styleSheet2" href="/css/default.css" rel="stylesheet" media="screen" type="text/css">
    <link id="styleSheet3" href="/css/layout.css" rel="stylesheet" media="all" type="text/css">
    <link href="/css/flexslider.css" rel="stylesheet" media="all" type="text/css">
    <link href="/css/jquery-ui.min.css" rel="stylesheet" media="all" type="text/css">
    <style type="text/css">
.abc{
display: none;
}
		
    </style>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:/ -->
    <!--[if lt IE 9]>
    <script type="text/javascript" src="js/html5shiv.js"></script>
    <script type="text/javascript" src="js/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script type="text/javascript" src="/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="/js/jquery.cookie.js"></script>
    <script type="text/javascript" src="/js/jquery.easing.js"></script>
    <script type="text/javascript" src="/js/jquery.flexslider.js"></script>
    <script type="text/javascript" src="/js/menu.js"></script>
    <script type="text/javascript" src="/js/bootstrap.js"></script>

	<script type="text/javascript" src="/js/moment.js"></script>
	<script type="text/javascript" src="/js/vue.min.js"></script>
	<script type="text/javascript" src="/js/vue-router.js"></script>
	<script type="text/javascript" src="/js/vue-extend.js"></script>
	<script type="text/javascript" src="/js/tmp.js"></script>
	<script type="text/javascript" src="/js/jquery.rwdImageMaps.min.js"></script>


    <script type="text/javascript">
		
var menu_id = '42';
var section_id = '2018010100000010126';

          

var startYear;
var endYear;
var	y_val;
var dataMissing = false;
var dataIncomplete = false;
function GetURLParameter(sParam){
	var sPageURL=window.location.search.substring(1);
	var sURLVariables=sPageURL.split('&');
	for(var i=0;i<sURLVariables.length;i++){
		var sParameterName=sURLVariables[i].split('=');
		if(sParameterName[0]==sParam){
			return sParameterName[1];
		}
	}
}
function ajax_get_data(y_val) {
	$.ajax({
		url: "../../cis/hko.xml",
		dataType: "text",
		success: function(aws) {
			var json = $.parseJSON(aws);
			for(var i = 0; i < json.hko.length; i++){
				if(json.hko[i].code == 'monthlyExtract'){
					startYear = json.hko[i].startYear;
					endYear = json.hko[i].endYear;
				}
			}
			if(y_val == null){
				y_val = endYear.toString();
			}else if(y_val > endYear){
				y_val = endYear.toString();
			} else if(y_val <startYear){
				y_val = startYear.toString();
			}
			$('#title').html('Monthly Extract of Meteorological Observations, ' + y_val);
			$('a[href*="cis/monthlyExtract"]').each(function(){
				if(-1 == $(this).attr("href").search('\\?y=') ){
					$(this).attr("href",$(this).attr("href")+'?y=' + y_val);
				}
			});
			$('a[onclick*="cis/monthlyExtract"]').each(function(){
				if(-1 == $(this).attr("onclick").search('\\?y=') ){
					var sOnClick = jQuery(this).attr('onclick');
					$(this).attr("onclick",sOnClick.replace('cis/monthlyExtract.htm.shtml','cis/monthlyExtract.htm.shtml?y=' + y_val));
				}
			});
			var yearDropdown = document.getElementById('yearDropdown'); 
			for(var i=endYear; i>=startYear; i--){
				if(i >1946 || i<1940){
					var option=document.createElement("option");
					option.text=i;
					option.value=i;
					if(i == y_val){
						option.selected = true;
					}
					try
					{
						yearDropdown.add(option,x.options[null]);
					}
					catch (e)
					{
						yearDropdown.add(option);
					}
				}  
			}
		}
	});
	$.ajax({
		url: "../../cis/monthlyExtract/monthlyExtract.xml",
		dataType: "text",
		success: function(xml) {
			var json = $.parseJSON(xml);
			//var tableContent = $('<table></table>').attr({'id':'t1','border':'1','cellpadding':'3','cellspacing':'0','summary':getChiNum(y_val) + '年' + '每月數據摘錄'}).css({'width':'740px'});
			var tableContent = $('<table></table>').attr({'id':'t1','class':'data_table table_border_1','summary':getChiNum(y_val) + '年' + '每月數據摘錄'}).css({'width':'740px'});
			//table header
			var header = $('<tr></tr>').css({'color':'#000000','background-color':'#FF8C00'}).appendTo(tableContent);
			$('<th></th>').attr({'rowspan':'3','class': 'td_normal_class'}).html('Month').appendTo(header);
			$('<th></th>').attr({'colspan':'10','class': 'td_normal_class'}).html('Hong  Kong  Observatory').appendTo(header);
			$('<th></th>').attr({'colspan':'1','class': 'td_normal_class'}).html('King\'s  Park').appendTo(header);
			$('<th></th>').attr({'colspan':'2','class': 'td_normal_class'}).html('Waglan  Island^').appendTo(header);
			var header1 = $('<tr></tr>').css({'color':'#000000','background-color':'#FF8C00'}).appendTo(tableContent);
			$('<th></th>').attr({'rowspan':'2','class': 'td_normal_class'}).html('Mean Pressure (hPa)').appendTo(header1);
			$('<th></th>').attr({'colspan':'5','class': 'td_normal_class'}).html('Air Temperature').appendTo(header1);
			$('<th></th>').attr({'rowspan':'2','class': 'td_normal_class'}).html('Mean Dew Point (deg. C)').appendTo(header1);
			$('<th></th>').attr({'rowspan':'2','class': 'td_normal_class'}).html('Mean Relative Humidity (%)').appendTo(header1);
			$('<th></th>').attr({'rowspan':'2','class': 'td_normal_class'}).html('Mean Amount <br>of Cloud (%)').appendTo(header1);
			$('<th></th>').attr({'rowspan':'2','class': 'td_normal_class'}).html('Total Rainfall (mm)').appendTo(header1);
			$('<th></th>').attr({'rowspan':'2','class': 'td_normal_class'}).html('Total Bright Sunshine (hours)').appendTo(header1);
			$('<th></th>').attr({'rowspan':'2','class': 'td_normal_class'}).html('Prevailing Wind Direction (degrees)').appendTo(header1);
			$('<th></th>').attr({'rowspan':'2','class': 'td_normal_class'}).html('Mean Wind Speed (km/h)').appendTo(header1);
			var header2 = $('<tr></tr>').css({'color':'#000000','background-color':'#FF8C00'}).appendTo(tableContent);
			$('<th></th>').attr({'class': 'td_normal_class'}).html('Absolute Daily Max (deg. C)').appendTo(header2);
			$('<th></th>').attr({'class': 'td_normal_class'}).html('Mean Daily Max (deg. C)').appendTo(header2);
			$('<th></th>').attr({'class': 'td_normal_class'}).html('Mean (deg. C)').appendTo(header2);
			$('<th></th>').attr({'class': 'td_normal_class'}).html('Mean Daily Min (deg. C)').appendTo(header2);
			$('<th></th>').attr({'class': 'td_normal_class'}).html('Absolute Daily Min (deg. C)').appendTo(header2);
			for(var i = 0; i < json.stn.data.length; i++){
				if(json.stn.data[i].year == y_val){
					for(var k = 0; k < json.stn.data[i].yearData.length; k++){
						var row = $('<tr></tr>').appendTo(tableContent);
						$('<td></td>').attr({'class': 'td1_year_class'}).html(json.stn.data[i].yearData[k][0]).appendTo(row);
						for(var j = 1; j < 14; j++){
							$('<td></td>').attr({'class': 'td1_normal_class'}).html(correctOutput(json.stn.data[i].yearData[k][j])).appendTo(row);
						}
					}
				}
			}
			tableContent.appendTo($("#dataTable"));
			$("#t1 tr:even").css("background-color","#F0F5F5");
			$("#t1 tr:odd").css("background-color","#C2D6FF");
		}
	});
}
function redirect()
{
	var y = document.getElementById("yearDropdown");
	var yearValue = y.options[y.selectedIndex].value;
	window.location = 'monthlyExtract.htm?y=' + yearValue;
}
function getChiNum(item)
{
	var str ="";
	var numArray= new Array("零","一","二","三","四","五","六","七","八","九");
	for(var i=0;i<item.length; i++){
		str = str + numArray[item.substr(i,1)];
	}
	return str;
}
function correctOutput(item){
	for(var i=0;i<item.length;i++){
		if(item.substr(i, 1) == ' '){
			item = item.substr(0,i) + "" + item.substr(i+1,item.length);
		}
	}
	if(!dataMissing && item.indexOf("*") > -1){
		dataMissing = true;
		document.getElementById('dataMissingRemark').innerHTML = '*** unavailable';
	}
	if(!dataIncomplete && item.indexOf("#") > -1){
		dataIncomplete = true;
		document.getElementById('dataIncompleteRemark').innerHTML = '# data incomplete';
	}

	return item;
}
$(document).ready(function(){
	y_val = GetURLParameter('y');
	ajax_get_data(y_val);
});
	</script>
</head>
<body id="page_bg">
<div id="skipwrapper">
    <a id="top" title="page top"></a>
    <a id="skiptocontent" href="#mainContentSkip" class="access">Skip Content</a>
</div>
<div id="wrap">
    <div id="header" class="headerArea">
        <div class="container">
            <div class="headerTool">
				<script type="text/javascript">createHeader();</script>
            </div>
        </div>
    </div>
    <div class="bodyArea">
        <div class="container">
            <div class="contentArea">
                <a id="mainContentSkip"></a>
                <div class="mainHeader"></div>
                <div class="breadcrumb"></div>
				<script type="text/javascript">pageTop();</script>
				<div id="mainContent" class="mainContent">
                <!--Begin Content-->
                <h1 class="no_h1">Monthly Extract of Meteorological Observations</h1>
                <div class="border_blank">
                    <!--Content Start-->
<div class="self_align_center" style="margin-bottom: 10px;">
<h1 id="title">&nbsp;</h1>
<button style="border: 0; background-color: #535353; color: #fff; padding: 0 15px; height: 32px; border-radius: 3px;" title="Back" onclick="window.location = '/tc/cis/climat.htm';">Back</button> <label for="yearDropdown">Year</label><select id="yearDropdown"></select><button style="border: 0; background-color: #535353; color: #fff; padding: 0 15px; height: 32px; border-radius: 3px;" title="Go" onclick="redirect()">Go</button></div>
<div id="dataTable" style="overflow-x: auto;"></div>
<br />
<div class="remark  self_align_left">
<div id="dataMissingRemark"></div>
</div>
<div class="remark  self_align_left">
<div id="dataIncompleteRemark"></div>
</div>
<!--<p># data incomplete</p>-->
<br /><p id="rfRemark">Trace means rainfall less than 0.05 mm</p>
<p class="remark  self_align_left">^ Information of wind direction and wind speed for Waglan Island are based on automatic weather station data since August 1989</p>
<!--Content End-->
<script>var last_revision_date = '29 July 2021';</script>
                </div>
				<!--End Content-->
                </div>
            </div>
            <script type="text/javascript">pageBottom();</script>
        </div>
    </div>
    <div id="footer" class="footerArea">
        <div class="container"> 
			<script type="text/javascript">createFooter();</script>
        </div>
    </div>
</div>
</body>
</html>